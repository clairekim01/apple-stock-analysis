<!DOCTYPE html>
<html>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load('visualization', '1', {packages: ['controls', 'charteditor']});
        google.setOnLoadCallback(prepData);

        function prepData() 
        {
            var _dataSourceURL = 'https://docs.google.com/spreadsheets/d/1dA8PHN4UaMDZ02Tqt4HrcuShV90zWnPkbUpGb2_Dtzg'
            var _urlSubWoQuery = '/gviz/tq?range=&tq='
            var queryStringClose = encodeURIComponent('SELECT A, B, C, D, E');

            var query = new google.visualization.Query(_dataSourceURL + _urlSubWoQuery + queryStringClose);
            query.send(handleSampleDataQueryResponse);
        }

        function handleSampleDataQueryResponse(response) 
        {
            if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;
                }

            var data = response.getDataTable();
    
            var dash = new google.visualization.Dashboard(document.getElementById('dashboard'));

            var control = new google.visualization.ControlWrapper({
                controlType: 'ChartRangeFilter',
                containerId: 'control_div',
                options: {
                    filterColumnIndex: 0,
                    ui: {
                        'labelStacking': 'vertical',
                        'allowTyping': false,
                        'allowMultiple': true,
                        chartOptions: 
                        {
                            height: 50,
                            width: 600,
                            chartArea: {
                                width: '80%'
                            }
                        }
                    }
                }
            });

            var chart = new google.visualization.ChartWrapper({
                chartType: 'LineChart',
                containerId: 'chart_div',
            });

            function setOptions (wrapper) 
            {
                wrapper.setOption('width', 1200);
                wrapper.setOption('chartArea.width', '80%');
            }
    
            setOptions(chart);
            
            dash.bind([control], [chart]);
            dash.draw(data);
            google.visualization.events.addListener(control, 'statechange', function () {
                var v = control.getState();
                document.getElementById('dbgchart').innerHTML = v.range.start+ ' to ' +v.range.end;
                return 0;
            });

            var toggleOpen = document.getElementById("toggleOpen");
            var openHidden = false;
            toggleOpen.onclick = function() 
            {
                openHidden = !openHidden;
                view = new google.visualization.DataView(data);
                if(openHidden){
                    view.hideColumns([1]);
                }
                dash.draw(view);
            }

            var toggleHigh = document.getElementById("toggleHigh");
            var highHidden = false;
            toggleHigh.onclick = function() 
            {
                highHidden = !highHidden;
                view = new google.visualization.DataView(data);
                if(highHidden){
                    view.hideColumns([2]);
                }
                dash.draw(view);
            }

            var toggleLow = document.getElementById("toggleLow");
            var lowHidden = false;
            toggleLow.onclick = function() 
            {
                lowHidden = !lowHidden;
                view = new google.visualization.DataView(data);
                if(lowHidden){
                    view.hideColumns([3]);
                }
                dash.draw(view);
            }

            var toggleClose = document.getElementById("toggleClose");
            var closeHidden = false;
            toggleClose.onclick = function() 
            {
                closeHidden = !closeHidden;
                view = new google.visualization.DataView(data);
                if(closeHidden){
                    view.hideColumns([4]);
                }
                dash.draw(view);
            }
}

</script>
<div id="dashboard">
    <div id="chart_div"></div>
    <div id="control_div"></div>
    <div id="categorySelector_div"></div>
<p><span id='dbgchart'></span></p>
<button type="button" id="toggleOpen">Open</button>
<button type="button" id="toggleHigh">High</button>
<button type="button" id="toggleLow">Low</button>
<button type="button" id="toggleClose">Close</button>
</div>
</html>