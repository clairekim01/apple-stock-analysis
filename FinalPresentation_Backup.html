<!DOCTYPE html>
<html>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load('visualization', '1', {packages: ['controls', 'charteditor']});
        google.setOnLoadCallback(prepData);

        var chargingBrickRemovalData;
        var iPadReleaseData;
        var iMacReleaseData;
        var iMacRelease_3MonthsData;

        function prepData()
        {
            var _dataSourceURL = 'https://docs.google.com/spreadsheets/d/1dA8PHN4UaMDZ02Tqt4HrcuShV90zWnPkbUpGb2_Dtzg';
            var _urlSubWoQuery_chargingBrickRemoval = '/gviz/tq?range=A7374:E7393&tq=';
            var _urlSubWoQuery_iPadRelease = '/gviz/tq?range=A7374:E7393&tq=';
            var _urlSubWoQuery_iMacRelease = '/gviz/tq?range=A7374:E7393&tq=';
            var _urlSubWoQuery_iMacRelease_3Months = '/gviz/tq?range=A7374:E7393&tq=';
            var _urlSubWoQuery_pandemic = '/gviz/tq?range=A7374:E7393&tq=';
            var queryString = encodeURIComponent('SELECT A, D, B, E, C');

            var query_chargingBrickRemoval = new google.visualization.Query(_dataSourceURL + _urlSubWoQuery_chargingBrickRemoval + queryString);
            var query_iPadRelease = new google.visualization.Query(_dataSourceURL + _urlSubWoQuery_iPadRelease + queryString);
            var query_iMacRelease = new google.visualization.Query(_dataSourceURL + _urlSubWoQuery_iMacRelease + queryString);
            var query_iMacRelease_3Months = new google.visualization.Query(_dataSourceURL + _urlSubWoQuery_iMacRelease_3Months + queryString);
            query_chargingBrickRemoval.send(handleResponse_chargingBrickRemoval);
            query_iPadRelease.send(handleResponse_iPadRelease);
            query_iMacRelease.send(handleResponse_iMacRelease);
            query_iMacRelease_3Months.send(handleResponse_iMacRelease_3Months);

            const myTimeout = setTimeout(drawDiffChart, 2000);
        }

        function handleResponse_chargingBrickRemoval(response)
        {
            if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;}
            chargingBrickRemovalData = response.getDataTable();
        }

        function handleResponse_iPadRelease(response)
        {
            if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;}
            iPadReleaseData = response.getDataTable();
        }

        function handleResponse_iMacRelease(response)
        {
            if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;}
            iMacReleaseData = response.getDataTable();
        }

        function handleResponse_iMacRelease_3Months(response)
        {
            if (response.isError()) {
                    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
                    return;}
            iMacReleaseData = response.getDataTable();
        }

        function drawDiffChart() {// Do nothing}

          chargingBrickRemoval.onclick = function()
          {
              var chart = new google.visualization.ChartWrapper({
                  chartType: 'CandlestickChart',
                  containerId: 'demo',
                  dataTable : chargingBrickRemovalData,
                  options:{
                      title: 'Apple Stock Market Summary - Removal of charging brick',
                      vAxis: {title: "Apple Stock Attributes",
                              format: "short"},
                      hAxis: {title: "Date",
                              format: 'dd-MMM-yyyy'},
                      height: 700,
                      width: 1350
                  }
              });
              chart.draw();
          }
          iPadRelease.onclick = function()
          {
              var chart = new google.visualization.ChartWrapper({
                  chartType: 'CandlestickChart',
                  containerId: 'demo',
                  dataTable : chargingBrickRemovalData,
                  options:{
                      title: 'Apple Stock Market Summary - 1st iPad release',
                      vAxis: {title: "Apple Stock Attributes",
                              format: "short"},
                      hAxis: {title: "Date",
                              format: 'dd-MMM-yyyy'},
                      height: 700,
                      width: 1350
                  }
              });
              chart.draw();
          }
          iMacRelease.onclick = function()
          {
              var chart = new google.visualization.ChartWrapper({
                  chartType: 'CandlestickChart',
                  containerId: 'demo',
                  dataTable : chargingBrickRemovalData,
                  options:{
                      title: 'Apple Stock Market Summary - 1st iMac release',
                      vAxis: {title: "Apple Stock Attributes",
                              format: "short"},
                      hAxis: {title: "Date",
                              format: 'dd-MMM-yyyy'},
                      height: 700,
                      width: 1350
                  }
              });
              chart.draw();
          }
          iMacRelease_3Months.onclick = function()
          {
              var chart = new google.visualization.ChartWrapper({
                  chartType: 'CandlestickChart',
                  containerId: 'demo',
                  dataTable : chargingBrickRemovalData,
                  options:{
                      title: 'Apple Stock Market Summary - iMac release\'s impact in 3 months',
                      vAxis: {title: "Apple Stock Attributes",
                              format: "short"},
                      hAxis: {title: "Date",
                              format: 'dd-MMM-yyyy'},
                      height: 700,
                      width: 1350
                  }
              });
              chart.draw();
          }

        }
    </script>

<div id="dashboard">
    <div id="demo">The Visualization Space</div>
    <button type="button" id="chargingBrickRemoval">Charging brick removal</button>
    <button type="button" id="iPadRelease">iPad release</button>
    <button type="button" id="iMacRelease">iMac release</button>
    <button type="button" id="iMacRelease_3Months">iMac release's impact in 3 months</button>
</div>
</html>
